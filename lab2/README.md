# Lab2 Report

##### 谢新格 PB19081644

#### 编译

使用cargo进行编译运行，rust为nightly版本（1.54.0-nightly）。

#### 选做内容

1. 使用rust完成必做和以下选做内容。
2. 基于TCP的重定向，实现 `cmd > /dev/tcp/<host>/<port>` 和 `cmd < /dev/tcp/<host>/<port>` 的重定向。
3. 替换环境变量，在解析命令时将$开的换成对应的环境变量，实现`echo $SHELL`，`cd $HOME`等，对所有环境变量有效。
4. 实现`set -u`，执行后，若$表示的环境变量不存在，则报错。
5. 实现`echo ~root`，`cd ~`，`cd ~<username>`等，能将单独出现的`~`的替换为当前的用户目录。

#### 使用 strace 工具追踪系统调用

- mmap：将一个文件或者其它对象映射进内存。文件被映射到多个页上，如果文件的大小不是所有页的大小之和，最后一个页不被使用的空间将会清零。
- munmap：执行与mmap相反的操作，删除特定地址区域的对象映射。
- fstat：用于获取文件的属性信息，例如文件类型，访问权限和访问信息等。
- sched_getaffinity：返回当前进程使用的cpu掩码。
- clone：的主要用途是创建一个线程，可以根据参数选择性复制进程的资源。

